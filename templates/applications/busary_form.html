{% extends 'base.html' %}
{% load static %}
{% block title %}Apply for Bursary{% endblock %}
{% block content %}

<div class="form-wrapper" role="main">
  <div class="form-header">
    <h1>West Pokot County Bursary Application Form 2024/2025 FY</h1>
    <p>Academic Year 2024 / 2025 — Fill in the details in legible capital letters and attach required documents. NB: Submission of incomplete form may lead to disqualification. All duly filled forms should be delivered on or before 29th November, 2024, at the ward Office for onward processing.</p>
  </div>

  <div class="progress-container">
    <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
    <div class="progress-steps">
      <div class="step" id="ps-1">1. Personal</div>
      <div class="step" id="ps-2">2. Institution</div>
      <div class="step" id="ps-3">3. Family</div>
      <div class="step" id="ps-4">4. Documents</div>
      <div class="step" id="ps-5">5. Declaration</div>
    </div>
  </div>

  <form id="bursaryForm" class="form-container" method="post" enctype="multipart/form-data" novalidate>
    {% csrf_token %}
    
    <!-- STEP 1: PERSONAL DETAILS -->
    <div class="form-section active" data-step="1" id="section-1">
      <div class="section-header">
        <div class="section-number active">1</div>
        <div class="section-title"><h2>Personal Details</h2><p>Applicant biodata</p></div>
      </div>
      <div class="section-content">
        <div class="form-row">
          <div class="form-group">
            <label class="required">{{ form.fullName.label }}</label>
            {{ form.fullName }}
            {% if form.fullName.errors %}
              <div class="error-message">{{ form.fullName.errors }}</div>
            {% endif %}
          </div>
          <div class="form-group">
            <label class="required">{{ form.idNumber.label }}</label>
            {{ form.idNumber }}
            {% if form.idNumber.errors %}
              <div class="error-message">{{ form.idNumber.errors }}</div>
            {% endif %}
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="required">{{ form.dob.label }}</label>
            {{ form.dob }}
            {% if form.dob.errors %}
              <div class="error-message">{{ form.dob.errors }}</div>
            {% endif %}
          </div>
          <div class="form-group">
            <label class="required">{{ form.gender.label }}</label>
            {{ form.gender }}
            {% if form.gender.errors %}
              <div class="error-message">{{ form.gender.errors }}</div>
            {% endif %}
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="required">{{ form.county.label }}</label>
            {{ form.county }}
            {% if form.county.errors %}
              <div class="error-message">{{ form.county.errors }}</div>
            {% endif %}
          </div>
          <div class="form-group">
            <label class="required">{{ form.subCounty.label }}</label>
            {{ form.subCounty }}
            {% if form.subCounty.errors %}
              <div class="error-message">{{ form.subCounty.errors }}</div>
            {% endif %}
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="required">{{ form.ward.label }}</label>
            {{ form.ward }}
            {% if form.ward.errors %}
              <div class="error-message">{{ form.ward.errors }}</div>
            {% endif %}
          </div>
          <div class="form-group">
            <label class="required">{{ form.location.label }}</label>
            {{ form.location }}
            {% if form.location.errors %}
              <div class="error-message">{{ form.location.errors }}</div>
            {% endif %}
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="required">{{ form.subLocation.label }}</label>
            {{ form.subLocation }}
            {% if form.subLocation.errors %}
              <div class="error-message">{{ form.subLocation.errors }}</div>
            {% endif %}
          </div>
          <div class="form-group">
            <label class="required">{{ form.village.label }}</label>
            {{ form.village }}
            {% if form.village.errors %}
              <div class="error-message">{{ form.village.errors }}</div>
            {% endif %}
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="required">{{ form.chiefName.label }}</label>
            {{ form.chiefName }}
            {% if form.chiefName.errors %}
              <div class="error-message">{{ form.chiefName.errors }}</div>
            {% endif %}
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="required">{{ form.phone.label }}</label>
            {{ form.phone }}
            {% if form.phone.errors %}
              <div class="error-message">{{ form.phone.errors }}</div>
            {% endif %}
          </div>
          <div class="form-group">
            <label>{{ form.email.label }}</label>
            {{ form.email }}
            {% if form.email.errors %}
              <div class="error-message">{{ form.email.errors }}</div>
            {% endif %}
          </div>
        </div>

        <div class="form-row single">
          <div class="form-group">
            <label class="required">{{ form.orphan.label }}</label>
            <div class="radio-group" role="radiogroup" aria-label="orphan">
              {% for radio in form.orphan %}
                <label class="radio-item">{{ radio.tag }} {{ radio.choice_label }}</label>
              {% endfor %}
            </div>
            {% if form.orphan.errors %}
              <div class="error-message">{{ form.orphan.errors }}</div>
            {% endif %}
          </div>
        </div>

        <div class="form-row single">
          <div class="form-group conditional" id="orphanNote">
            <label>Orphan status selected — you will be required to provide guardianship documents in attachments.</label>
          </div>
        </div>

        <div class="form-row single">
          <div class="form-group">
            <label class="required">{{ form.disability.label }}</label>
            <div class="radio-group" role="radiogroup" aria-label="disability">
              {% for radio in form.disability %}
                <label class="radio-item">{{ radio.tag }} {{ radio.choice_label }}</label>
              {% endfor %}
            </div>
            {% if form.disability.errors %}
              <div class="error-message">{{ form.disability.errors }}</div>
            {% endif %}
          </div>
        </div>

        <div class="conditional" id="disabilityDetails">
          <div class="form-row">
            <div class="form-group">
              <label>{{ form.disabilityNature.label }}</label>
              {{ form.disabilityNature }}
            </div>
            <div class="form-group">
              <label>{{ form.disabilityRegNo.label }}</label>
              {{ form.disabilityRegNo }}
            </div>
          </div>
        </div>

        <div class="form-row single">
          <div class="form-group">
            <label class="required">{{ form.previousBursary.label }}</label>
            <div class="radio-group" role="radiogroup" aria-label="previousBursary">
              {% for radio in form.previousBursary %}
                <label class="radio-item">{{ radio.tag }} {{ radio.choice_label }}</label>
              {% endfor %}
            </div>
            {% if form.previousBursary.errors %}
              <div class="error-message">{{ form.previousBursary.errors }}</div>
            {% endif %}
          </div>
        </div>

        <div class="form-row conditional" id="previousBursaryDetails">
          <div class="form-group">
            <label>{{ form.cdfAmount.label }}</label>
            {{ form.cdfAmount }}
          </div>
          <div class="form-group">
            <label>{{ form.ministryAmount.label }}</label>
            {{ form.ministryAmount }}
          </div>
        </div>
        <div class="form-row conditional" id="previousBursaryDetailsContinued">
          <div class="form-group">
            <label>{{ form.countyGovAmount.label }}</label>
            {{ form.countyGovAmount }}
          </div>
          <div class="form-group">
            <label>{{ form.otherBursary.label }}</label>
            {{ form.otherBursary }}
          </div>
        </div>

        <div class="navigation">
          <div></div>
          <div>
            <button type="button" class="btn btn-primary" id="toStep2">Next</button>
          </div>
        </div>
      </div>
    </div>

    <!-- STEP 2: INSTITUTION -->
    <div class="form-section" data-step="2" id="section-2">
      <div class="section-header">
        <div class="section-number">2</div>
        <div class="section-title"><h2>Institution Details</h2><p>School/college info</p></div>
      </div>
      <div class="section-content">
        <div class="form-row">
          <div class="form-group">
            <label class="required">{{ form.institution.label }}</label>
            {{ form.institution }}
            {% if form.institution.errors %}
              <div class="error-message">{{ form.institution.errors }}</div>
            {% endif %}
          </div>
          <div class="form-group">
            <label class="required">{{ form.level.label }}</label>
            {{ form.level }}
            {% if form.level.errors %}
              <div class="error-message">{{ form.level.errors }}</div>
            {% endif %}
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="required">{{ form.course.label }}</label>
            {{ form.course }}
            {% if form.course.errors %}
              <div class="error-message">{{ form.course.errors }}</div>
            {% endif %}
          </div>
          <div class="form-group">
            <label class="required">{{ form.yearForm.label }}</label>
            {{ form.yearForm }}
            {% if form.yearForm.errors %}
              <div class="error-message">{{ form.yearForm.errors }}</div>
            {% endif %}
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="required">{{ form.instCounty.label }}</label>
            {{ form.instCounty }}
            {% if form.instCounty.errors %}
              <div class="error-message">{{ form.instCounty.errors }}</div>
            {% endif %}
          </div>
          <div class="form-group">
            <label class="required">{{ form.instContact.label }}</label>
            {{ form.instContact }}
            {% if form.instContact.errors %}
              <div class="error-message">{{ form.instContact.errors }}</div>
            {% endif %}
          </div>
        </div>

        <div class="form-row single">
          <div class="form-group">
            <label>School Performance (for continuing students)</label>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>{{ form.term1.label }}</label>
            {{ form.term1 }}
          </div>
          <div class="form-group">
            <label>{{ form.term2.label }}</label>
            {{ form.term2 }}
          </div>
          <div class="form-group">
            <label>{{ form.term3.label }}</label>
            {{ form.term3 }}
          </div>
        </div>

        <div class="navigation">
          <button type="button" class="btn btn-secondary" id="backTo1">Back</button>
          <button type="button" class="btn btn-primary" id="toStep3">Next</button>
        </div>
      </div>
    </div>

    <!-- STEP 3: FAMILY -->
    <div class="form-section" data-step="3" id="section-3">
      <div class="section-header">
        <div class="section-number">3</div>
        <div class="section-title"><h2>Family Details</h2><p>Parent or guardian information</p></div>
      </div>
      <div class="section-content">
        <div class="form-row">
          <div class="form-group">
            <label>{{ form.fatherName.label }}</label>
            {{ form.fatherName }}
          </div>
          <div class="form-group">
            <label>{{ form.motherName.label }}</label>
            {{ form.motherName }}
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="required">{{ form.guardianName.label }}</label>
            {{ form.guardianName }}
          </div>
          <div class="form-group">
            <label class="required">{{ form.relation.label }}</label>
            {{ form.relation }}
            {% if form.relation.errors %}
              <div class="error-message">{{ form.relation.errors }}</div>
            {% endif %}
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>{{ form.fatherOccupation.label }}</label>
            {{ form.fatherOccupation }}
          </div>
          <div class="form-group">
            <label>{{ form.motherOccupation.label }}</label>
            {{ form.motherOccupation }}
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="required">{{ form.parentPhone.label }}</label>
            {{ form.parentPhone }}
            {% if form.parentPhone.errors %}
              <div class="error-message">{{ form.parentPhone.errors }}</div>
            {% endif %}
          </div>
          <div class="form-group">
            <label>{{ form.parentId.label }}</label>
            {{ form.parentId }}
          </div>
        </div>

        <div class="form-row single">
          <div class="form-group">
            <label class="required">{{ form.bothParentsAlive.label }}</label>
            <div class="radio-group" role="radiogroup" aria-label="bothParentsAlive">
              {% for radio in form.bothParentsAlive %}
                <label class="radio-item">{{ radio.tag }} {{ radio.choice_label }}</label>
              {% endfor %}
            </div>
            {% if form.bothParentsAlive.errors %}
              <div class="error-message">{{ form.bothParentsAlive.errors }}</div>
            {% endif %}
          </div>
        </div>

        <div class="form-row single">
          <div class="form-group">
            <label class="required">{{ form.singleParent.label }}</label>
            <div class="radio-group" role="radiogroup" aria-label="singleParent">
              {% for radio in form.singleParent %}
                <label class="radio-item">{{ radio.tag }} {{ radio.choice_label }}</label>
              {% endfor %}
            </div>
            {% if form.singleParent.errors %}
              <div class="error-message">{{ form.singleParent.errors }}</div>
            {% endif %}
          </div>
        </div>

        <div class="conditional" id="providerNote">
          <div class="form-row single">
            <div class="form-group">
              <label>{{ form.feesProvider.label }}</label>
              {{ form.feesProvider }}
            </div>
            <div class="form-group">
              <label>{{ form.otherProvider.label }}</label>
              {{ form.otherProvider }}
            </div>
          </div>
        </div>

        <div class="navigation">
          <button type="button" class="btn btn-secondary" id="backTo2">Back</button>
          <button type="button" class="btn btn-primary" id="toStep4">Next</button>
        </div>
      </div>
    </div>

    <!-- STEP 4: DOCUMENTS -->
    <div class="form-section" data-step="4" id="section-4">
      <div class="section-header">
        <div class="section-number">4</div>
        <div class="section-title"><h2>Attachments / Documents</h2><p>Upload required documents</p></div>
      </div>
      <div class="section-content">
        <p>Key Attachments: Students' transcript/Report Form, Photocopy of Parents'/Guardians National Identity Card, Photocopy of students' National Identity Card (mandatory for post school students), Photocopy of Birth certificate, Photocopy of secondary/college/university ID card, Parents death certificate/burial permit/letter (mandatory for orphans), Current fees structure (mandatory for all applicants), Admission Letters (mandatory for colleges and universities), Student Passport Photo.</p>

        <div class="form-row single">
          <div class="form-group">
            <label class="required">{{ form.idFile.label }}</label>
            <div class="file-upload" id="fileIdUpload">
              <label class="file-upload-label">
                <span>Select file</span>
                {{ form.idFile }}
              </label>
              <div id="idFilePreview" class="file-preview"></div>
            </div>
            {% if form.idFile.errors %}
              <div class="error-message">{{ form.idFile.errors }}</div>
            {% endif %}
          </div>
        </div>

        <div class="form-row single">
          <div class="form-group">
            <label class="required">{{ form.reportForm.label }}</label>
            <div class="file-upload">
              <label class="file-upload-label">
                <span>Select file</span>
                {{ form.reportForm }}
              </label>
              <div id="reportFormPreview" class="file-preview"></div>
            </div>
            {% if form.reportForm.errors %}
              <div class="error-message">{{ form.reportForm.errors }}</div>
            {% endif %}
          </div>
        </div>

        <div class="form-row single">
          <div class="form-group">
            <label>{{ form.parentIdFile.label }}</label>
            <div class="file-upload">
              <label class="file-upload-label">
                <span>Select file</span>
                {{ form.parentIdFile }}
              </label>
              <div id="parentIdFilePreview" class="file-preview"></div>
            </div>
          </div>
        </div>

        <div class="form-row single">
          <div class="form-group">
            <label>{{ form.studentIdFile.label }}</label>
            <div class="file-upload">
              <label class="file-upload-label">
                <span>Select file</span>
                {{ form.studentIdFile }}
              </label>
              <div id="studentIdFilePreview" class="file-preview"></div>
            </div>
          </div>
        </div>

        <div class="form-row single">
          <div class="form-group">
            <label>{{ form.instIdFile.label }}</label>
            <div class="file-upload">
              <label class="file-upload-label">
                <span>Select file</span>
                {{ form.instIdFile }}
              </label>
              <div id="instIdFilePreview" class="file-preview"></div>
            </div>
          </div>
        </div>

        <div class="form-row single">
          <div class="form-group">
            <label>{{ form.instLetter.label }}</label>
            <div class="file-upload">
              <label class="file-upload-label">
                <span>Select file</span>
                {{ form.instLetter }}
              </label>
              <div id="instLetterPreview" class="file-preview"></div>
            </div>
          </div>
        </div>

        <div class="form-row single">
          <div class="form-group">
            <label>{{ form.guardianFile.label }}</label>
            <div class="file-upload">
              <label class="file-upload-label">
                <span>Select file</span>
                {{ form.guardianFile }}
              </label>
              <div id="guardianFilePreview" class="file-preview"></div>
            </div>
          </div>
        </div>

        <div class="form-row single">
          <div class="form-group">
            <label>{{ form.passportPhoto.label }}</label>
            <div class="file-upload">
              <label class="file-upload-label">
                <span>Select file</span>
                {{ form.passportPhoto }}
              </label>
              <div id="passportPhotoPreview" class="file-preview"></div>
            </div>
          </div>
        </div>

        <div class="navigation">
          <button type="button" class="btn btn-secondary" id="backTo3">Back</button>
          <button type="button" class="btn btn-primary" id="toStep5">Next</button>
        </div>
      </div>
    </div>

    <!-- STEP 5: DECLARATION -->
    <div class="form-section" data-step="5" id="section-5">
      <div class="section-header">
        <div class="section-number">5</div>
        <div class="section-title"><h2>Declaration & Submit</h2><p>Confirm and submit</p></div>
      </div>
      <div class="section-content">
        <div class="form-row single">
          <div class="form-group">
            <label>Student Declaration</label>
            <p>I, herein, declare to the best of my knowledge that the information given is true. I understand that giving false information is punishable under section 129(a) of the Penal Code of Kenya and may lead to disqualification.</p>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label class="required">{{ form.signature.label }}</label>
            {{ form.signature }}
            {% if form.signature.errors %}
              <div class="error-message">{{ form.signature.errors }}</div>
            {% endif %}
          </div>
          <div class="form-group">
            <label class="required">{{ form.studentDate.label }}</label>
            {{ form.studentDate }}
            {% if form.studentDate.errors %}
              <div class="error-message">{{ form.studentDate.errors }}</div>
            {% endif %}
          </div>
        </div>

        <div class="form-row single">
          <div class="form-group">
            <label>Parent/Guardian Declaration</label>
            <p>I declare that I have read this form or it has been read to me and I hereby confirm that the information given hereunder is true to the best of my knowledge. I understand that giving false information is punishable under section 129(a) of the Penal Code of Kenya and may lead to disqualification.</p>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label class="required">{{ form.parentSignature.label }}</label>
            {{ form.parentSignature }}
            {% if form.parentSignature.errors %}
              <div class="error-message">{{ form.parentSignature.errors }}</div>
            {% endif %}
          </div>
          <div class="form-group">
            <label class="required">{{ form.parentDate.label }}</label>
            {{ form.parentDate }}
            {% if form.parentDate.errors %}
              <div class="error-message">{{ form.parentDate.errors }}</div>
            {% endif %}
          </div>
        </div>

        <div class="form-row single">
          <div class="form-group">
            <label>Verification by Area Assistant Chief</label>
            <div class="form-row">
              <div class="form-group">
                <label>{{ form.chiefFullName.label }}</label>
                {{ form.chiefFullName }}
              </div>
              <div class="form-group">
                <label>{{ form.chiefSubLocation.label }}</label>
                {{ form.chiefSubLocation }}
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label>{{ form.chiefCounty.label }}</label>
                {{ form.chiefCounty }}
              </div>
              <div class="form-group">
                <label>{{ form.chiefSubCounty.label }}</label>
                {{ form.chiefSubCounty }}
              </div>
              <div class="form-group">
                <label>{{ form.chiefLocation.label }}</label>
                {{ form.chiefLocation }}
              </div>
            </div>
            <div class="form-row single">
              <div class="form-group">
                <label>{{ form.chiefComments.label }}</label>
                {{ form.chiefComments }}
              </div>
            </div>
            <p>I certify that the Information given above is correct.</p>
            <div class="form-row">
              <div class="form-group">
                <label>{{ form.chiefSignature.label }}</label>
                {{ form.chiefSignature }}
              </div>
              <div class="form-group">
                <label>{{ form.chiefDate.label }}</label>
                {{ form.chiefDate }}
              </div>
              <div class="form-group">
                <label>{{ form.rubberStamp.label }}</label>
                {{ form.rubberStamp }}
              </div>
            </div>
          </div>
        </div>

        <div class="form-row single">
          <div class="form-group">
            <label>{{ form.notes.label }}</label>
            {{ form.notes }}
          </div>
        </div>

        <div class="success-message" id="successMsg">Your application was submitted successfully.</div>
        <div class="error-message" id="errorMsg">There was an error submitting your application. Try again.</div>

        <div class="navigation">
          <button type="button" class="btn btn-secondary" id="backTo4">Back</button>
          <button type="submit" class="btn btn-primary" id="submitBtn">Submit Application</button>
        </div>
      </div>
    </div>
  </form>
</div>

<div class="floating-help" title="Help" id="helpBtn">?</div>

{% endblock %}